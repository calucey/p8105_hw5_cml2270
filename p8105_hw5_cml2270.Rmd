---
title: "P8105 Homework 5: Iteration"
author: "Catherine Lucey (cml2270)"
date: "11/11/2021"
output: html_document
---

# Setup
Only done once, the setup code loads the necessary libraries and double checks that the working directory is correct. It also sets defaults for figure size with knitr, as well as a default theme and color scale for all ggplots.

```{r setup}
library(tidyverse)
library(readr)
getwd()

knitr::opts_chunk$set(
  fig.width = 10,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

```

# Problem 1: Washington Post Unsolved Homicides Data

#### Installing and Describing the WaPo Homicides Data

```{r load data}

urlfile = "https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv"

hom_df = read_csv(url(urlfile)) %>% 
   mutate(city_state = str_c(city, ", ", state))
  
```

The homicides dataset contains 53179 observations of 12 variables, these variables include LITERALLY HOW DO YOU DO THIS/???

```{r clean data}

n_homs =
  hom_df %>% 
  group_by(city_state, disposition) %>%
  summarise(n_hom_type = n()) %>% 
  mutate(n_hom_type = as.numeric(n_hom_type)) %>% 
  pivot_wider(names_from = disposition,
              values_from = n_hom_type
  ) %>% 
  mutate(`Closed without arrest` = replace_na(`Closed without arrest`, 0)) %>% 
  mutate(`Open/No arrest` = replace_na(`Open/No arrest`, 0)) %>% 
  mutate(n_total_homs = sum(`Closed by arrest`, `Closed without arrest` , `Open/No arrest`)) %>% 
  mutate(n_unsolved = sum(`Closed without arrest`, `Open/No arrest`)) %>% 
  select(city_state, n_total_homs, n_unsolved)

```

#### Proportion Unsolved Homicides in Baltimore, MD

```{r}

bmore_unsolved =
  n_homs %>% 
  filter(city_state == "Baltimore, MD") %>%
  ungroup() %>% 
  select(n_unsolved, n_total_homs) %>% 
  prop.test(alternative = "two.sided", conf.level = 0.95, correct = FALSE)

```

# Problem 2: Trial Data

This zip file contains data from a longitudinal study that included a control arm and an experimental arm. Data for each participant is included in a separate file, and file names include the subject ID and arm.

Create a tidy dataframe containing data from all participants, including the subject ID, arm, and observations over time:

    Start with a dataframe containing all file names; the list.files function will help
    Iterate over file names and read in data for each subject using purrr::map and saving the result as a new variable in the dataframe
    Tidy the result; manipulate file names to include control arm and subject ID, make sure weekly observations are “tidy”, and do any other tidying that’s necessary

Make a spaghetti plot showing observations on each subject over time, and comment on differences between groups.


```{r}



```

